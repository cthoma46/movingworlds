extends layouts/layout

block append scripts
	if mine
		script(src='/javascript/plugins/jquery-ui.min.js')
		script(src='/javascript/plugins/jquery.mw_combo.js')
		script(src='/javascript/plugins/jquery.tag-it.js')
		script(src='/javascript/plugins/jquery.catcomplete.js')
		script(src='/javascript/plugins/jquery.select-it.js')
		script(src='/javascript/plugins/jquery.dropdown.js')
		script(src='/javascript/plugins/jquery.extend.js')
		script(src='/javascript/plugins/jquery.validate.min.js')
		script(src='/javascript/experteer.js')

block content
	div.layout_960
		aside#personal_details.col1of2
			div.widget.experteer
				header
					div.icon
					h3= experteer.fullName()
				section.widget_body
					div.avatar
						.av_img_container
							if experteer.avatar || experteer.type
								img(src= experteer.avatar || "/images/icn_avatar_"+experteer.type+".png", width="80", height="80")
							if experteer.verified
								div.verified
					ul
						li
							strong Location&nbsp;
							= experteer.city+", "+experteer.country
						if experteer.birthday
							li
								strong Age&nbsp;
								=experteer.age()
						if experteer.industry
							li
								strong Industry&nbsp;
								=experteer.industry
						if experteer.experience && experteer.experience > 0
							li
								strong Experience&nbsp;
								| #{experteer.experience} years
					if mine
						nav
							ul
								li
									a(href="/settings").chunky_btn Edit my profile
			div.detail.clearfix
				//- nav.credentials.clearfix
					ul
						li
							a.friends_btn(href="/explore") 101
								span Friends
						li
							a.invited_btn(href="/explore") 5
								span invited
							- if(typeof experteer.invite.invited_by !== 'undefined')
								li.invited_by
									span invited by
									a(href="#")= experteer.invite.invited_by
				nav.profile_links
					ul
						if experteer.links
							each link, key in experteer.links
								-var display = (key == 'url') ? link : key
								if link !== ''
									li
										a(href=link, class=key+'_link', )= display

			if experteer.bio && experteer.bio.length > 0
				div.detail
					h4 Biography
					=experteer.bio

			if experteer.education && experteer.education.length > 0
				div.detail
					h4 Education
					each edu in experteer.education
						ul
							li
								strong= edu.school
							li= edu.degree+" "+edu.major
							if edu.start && edu.end
								li= edu.start.getFullYear()+" to "+edu.end.getFullYear();

			if experteer.employment && experteer.employment.length > 0
				div.detail
					h4 Employment History
					each emp in experteer.employment
						ul
							li
								strong= emp.title
							li= emp.employer
							if emp.start && emp.end
								li= emp.start.getFullYear()+" to "+emp.end.getFullYear();

			if experteer.languages && experteer.languages.length
				div.detail
					h4 Languages
					ul
						each lang in experteer.languages
							li= lang

			//- if experteer.lived && experteer.lived.length
				div.detail
					h4 Lived
					=experteer.lived.join(', ');

			if experteer.visited && experteer.visited.length > 0
				div.detail
					h4 Countries Visited
					=experteer.visited.join(', ');

			if experteer.skills && experteer.skills.length > 0
				div.detail
					h4 Skills
					=experteer.skills.join(', ');

		// Experteering Profile
		div#exp_profile.col2of2
			section.status_bar
				-var status = experteer.interpretStatus();
				div(class="status "+status.class)= status.label
				nav
					if mine
						ul
							li
								a(data-dropdown='#status').chunky_btn.select Change your status
								div(id="status", class="dropdown dropdown-tip")
									ul.dropdown-menu
										li
											a(href='#', class='change_status', data-status='0') Currently Not Seeking Experteering Opportunity
										li
											a(href='#', class='change_status', data-status='1') Seeking Experteering Opportunity
										li
											a(href='#', class='change_status', data-status='2') Discussing an Experteering Opportunity
										li
											a(href='#', class='change_status', data-status='3') Currently Experteering on Location
							//-li
								a.smooth_btn.red Favorite
					else
						ul
							li
								a.smooth_btn.green Request Intro
							//-li
								a.smooth_btn.red Favorite
			section.stack_630
				form(action="/experteer/update", method="POST")
					header
						if experteer.headline
							h2.experteering_icon= experteer.headline
						else
							h2.experteering_icon Your experteer profile
						if mine
							div(style="text-align: right")
								button#edit_profile.chunky_btn Edit my experteer profile
					div.stack_body.clearfix
							- if(mine && !experteer.isProfileComplete())
								p.error Your profile is incomplete, please fill the information below
								br
							div#profile_info
								div.clearfix
								div.col1of2
									// Availability
									- var availability = experteer.profile.availability && experteer.profile.availability.start && experteer.profile.availability.end
									if !availability && mine
										availability_class = 'error'
									h4(class=availability_class) Availability
									p
										if availability
											dstart = (typeof experteer.profile.availability.start !== 'undefined' && experteer.profile.availability.start != null) ? settings.moment(experteer.profile.availability.start).format('MM/DD/YYYY') : ""
											dend = (typeof experteer.profile.availability.end !== 'undefined' && experteer.profile.availability.end != null) ? settings.moment(experteer.profile.availability.end).format('MM/DD/YYYY') : ""
											| From #{dstart} to #{dend}
										else
											| No information specified
									// Countries
									- var countries = experteer.profile.countries && experteer.profile.countries.length > 0
									if !countries && mine
										countries_class = 'error'
									h4(class=countries_class) I'd like to go to
									p
										if countries
											- selectedCountries = []
											- for ( var c = 0; c < experteer.profile.countries.length; c++ ) {
												- code = experteer.profile.countries[c];
												- selectedCountries.push(countryList[code] || regionList[code]);
											- }
											= selectedCountries.join(", ");
										else
											| No information specified
									// Industry
									- var environment = experteer.profile.environment && experteer.profile.environment.length > 0
									if !environment && mine
										environment_class = 'error'
									h4(class=environment_class) Preferred Work Environment
									p
										if environment
											=experteer.profile.environment.join(', ')
										else
											| No information specified
									// Development Impact
									- var impact = experteer.profile.impact
									if !impact && mine
										impact_class = 'error'
									h4(class=impact_class) I'd like to make a positive impact in
									p
										if impact
											=experteer.interpretImpact()
										else
											| No information specified
								div.col2of2
									// Value
									- var value = experteer.profile.value
									if !value && mine
										value_class = 'error'
									h4(class=value_class) Monetized Value
									p
										if value
											| #{experteer.profile.value} USD / hour
										else
											| No information specified
									// Area Support
									- var support = experteer.area_support && experteer.area_support.length > 0
									if mine && !support
										support_class = 'error'
									h4(class=support_class) Preferred Area of Support
									p
										if support
											= experteer.interpretAreaSupport().join(', ')
											input(id="area_support_values", type="hidden", value=JSON.stringify(experteer.areaSupportObject()))
										else
											| No information specified
									// Motivation
									- var motivation = experteer.profile.motivation
									if mine && !motivation
										motivation_class = 'error'
									h4(class=motivation_class) I get motivated & inspired by
									p
										if motivation
											| #{experteer.profile.motivation}
										else
											| No information specified
							if mine
								div#profile_form.hidden
									div.clearfix
										div.col1of2
											h4 Availability
											ul
												li.datepicker
													label From
													- var dstart = (typeof experteer.profile.availability.start !== 'undefined' && experteer.profile.availability.start != null) ? settings.moment(experteer.profile.availability.start).format('MM/DD/YYYY') : ""
													- var dend = (typeof experteer.profile.availability.end !== 'undefined' && experteer.profile.availability.end != null) ? settings.moment(experteer.profile.availability.end).format('MM/DD/YYYY') : ""

													input( type="text", name="profile[availability][start]", data-months="1", data-years="2", value=dstart)
												li.datepicker
													label To
													input( type="text", name="profile[availability][end]", data-months="1", data-years="2", value=dend)
											h4 I'd like to go to
											ul
												li
													select( id="countries", name="profile[countries]", class="selectit-me", multiple=true)
														optgroup(label="Regions")
															- for( var key in regionList) {
																- var isSelected = experteer.profile.countries.indexOf(key) > -1;
																option(value=key,selected=isSelected)= regionList[key]
															- }
														optgroup(label="Countries")
															- for( var key in countryList) {
																- var isSelected = experteer.profile.countries.indexOf(key) > -1;
																option(value=key,selected=isSelected)= countryList[key]
															- }
											h4 Preferred Work Environment
											div.checkboxes
												ul
													li.half
														input(type='checkbox', name='profile[environment]', value="Private Sector", checked=experteer.profile.environment.indexOf('Private Sector') > -1)
														label Private Sector
													li.half
														input(type='checkbox', name='profile[environment]', value="Urban", checked=experteer.profile.environment.indexOf('Urban') > -1)
														label Urban
												ul
													li.half
														input(type='checkbox', name='profile[environment]', value="NGO", checked=experteer.profile.environment.indexOf('NGO') > -1)
														label NGO
													li.half
														input(type='checkbox', name='profile[environment]', value="Rural", checked=experteer.profile.environment.indexOf('Rural') > -1)
														label Rural
												ul
													li.half
														input(type='checkbox', name='profile[environment]', value="Government", checked=experteer.profile.environment.indexOf('Government') > -1)
														label Government
													li.half
														input(type='checkbox', name='profile[environment]', value="Nature", checked=experteer.profile.environment.indexOf('Nature') > -1)
														label Nature
												ul(style="height: 100px")
													li.half
														input(type='checkbox', name='profile[environment]', value="Research", checked=experteer.profile.environment.indexOf('Research') > -1)
														label Research
													li.half
														input(type='checkbox', name='profile[environment]', value="Anywhere", checked=experteer.profile.environment.indexOf('Anywhere') > -1)
														label Anywhere
											h4 I'd like to make a positive impact in
											ul
												li
													input(id='impact_value', type='hidden', value=experteer.profile.impact)
													select( id="impact", name="profile[impact]", tabindex="15", class="combobox")
														include includes/impact_combo.jade
										div.col2of2
											h4 Monetized Value
											ul
												li
													label USD/hour
													input(type="text", name="profile[value]", value=experteer.profile.value)
											h4 Preferred Area of Support
											ul
												li
													label
														span max 6
													select(id="area_support", tabindex="9").combobox
														include includes/area_support_combo
													a(style="margin-top: 5px")#add_area_support.chunky_btn.small.right Add
													div#areas.tagit
											h4 I get motivated & inspired by
											ul
												li
													label
														span max 500 characters
													textarea(name="profile[motivation]", placeholder="E.g: I love to work on musical projects, the combination of music and teaching makes me tick!")
														=experteer.profile.motivation
										div.clearfix.center
										button(type='submit')#save_profile.chunky_btn.blue.right Save
										button#cancel_profile.chunky_btn.right Cancel
				footer